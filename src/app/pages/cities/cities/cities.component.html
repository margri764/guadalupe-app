
<div class="customShadow w-100 pd-20" style="border-radius: 7px;">
    <form  [formGroup]="myForm"  style="margin-top: 30px;" (ngSubmit)="postCity()" >  
        
        <div class="row mb-40">
            <div class="col-sm-12 col-12 col-md-6" >
                <mat-label class="font f-w-600 m-b-8 d-block">Buscar Cidade <b style="color: red;">*</b> </mat-label>
                <mat-form-field appearance="outline" class="w-100" color="primary"  >
                <input matInput type="text"  formControlName="search" #inputPlaces id="inputPlaces" placeholder="" formControlName="search"  />
            </mat-form-field>
            </div>
       </div>

    
    <div class="maps mt-5 " #divMap ></div>
        

       <div class="mt-30 row fs-10" >     
        
            <div class=" col-sm-12 col-12 col-md-4 mt-30" >
                <mat-label class="font f-w-600 m-b-8 d-block">Cidade <b style="color: red;">*</b> </mat-label>
                <mat-form-field appearance="outline" class="w-100" color="primary"  >
                <input matInput type="text"  formControlName="name"   />
                @if(f['name'].touched && f['name'].invalid) {
                    <mat-hint class="m-b-16 error-msg">
                    @if(f['name'].errors && f['name'].errors['required']) {
                    <div class="error">Dado obrigatorio.</div>
                    } 
                    </mat-hint>
                    }
                </mat-form-field>
            </div>

            <div class="col-sm-12 col-12 col-md-4 mt-30" >
                <mat-label class="font f-w-600 m-b-8 d-block">Region <b style="color: red;">*</b> </mat-label>
                <mat-form-field appearance="outline" class="w-100" color="primary"  >
                <input matInput type="text"  formControlName="province"   />
                @if(f['province'].touched && f['province'].invalid) {
                    <mat-hint class="m-b-16 error-msg">
                    @if(f['province'].errors && f['province'].errors['required']) {
                    <div class="error">Dado obrigatorio.</div>
                    } 
                    </mat-hint>
                    }
                </mat-form-field>
            </div>

            <div class="col-sm-12 col-12 col-md-4 mt-30" >
                <mat-label class="font f-w-600 m-b-8 d-block">País <b style="color: red;">*</b> </mat-label>
                <mat-form-field appearance="outline" class="w-100" color="primary"  >
                <input matInput type="text"  formControlName="country"   />
                @if(f['country'].touched && f['country'].invalid) {
                    <mat-hint class="m-b-16 error-msg">
                    @if(f['country'].errors && f['country'].errors['required']) {
                    <div class="error">Dado obrigatorio.</div>
                    } 
                    </mat-hint>
                    }
                </mat-form-field>
            </div>

         
      
       </div>

       <div class="d-flex justify-content-start align-items-center mt-50 w-100"  > 

        <button mat-raised-button  cdkFocusInitial style="background-color: rgb(0, 119, 255); color: white; font-family: poppins-regular" >  <i class="fas fa-plus "></i> &nbsp;Agregar cidade</button> 
            
      </div>


    </form>

</div>

<div class="row pd-20">

    <div class="mat-elevation-z8 mt-20 pd-20">
          
      <div class="d-flex justify-content-between align-items-center w-100">
  
          <mat-form-field appearance="outline" color="primary" >
              <input matInput placeholder="Procurar aqui" (keyup)="applyFilter($event)" />
            </mat-form-field>
      </div>
  
      <table mat-table [dataSource]="dataSource" matSort   >

        <ng-container matColumnDef="img" >
            <th mat-header-cell *matHeaderCellDef  > Img </th>
            <td mat-cell *matCellDef="let city"> 
                <img [src]="city.flag"  width="60px">
                <img src="assets/images/no-image.jpg" width="60px" *ngIf="!city.flag || city.flag === ''"> 
            </td>
          </ng-container>
  
          <ng-container matColumnDef="name" >
              <th mat-header-cell *matHeaderCellDef  mat-sort-header > Nome </th>
              <td mat-cell *matCellDef="let city"> 
                  {{ city.name }}
             </td>
            </ng-container>
  
          <ng-container matColumnDef="province" >
              <th mat-header-cell *matHeaderCellDef  mat-sort-header > Region </th>
              <td mat-cell *matCellDef="let city"> 
                  {{ city.province }}
             </td>
            </ng-container>
  
          <ng-container matColumnDef="country" >
              <th mat-header-cell *matHeaderCellDef  mat-sort-header > País </th>
              <td mat-cell *matCellDef="let city"> 
                  {{ city.province }}
             </td>
            </ng-container>

            <ng-container matColumnDef="propulsao">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Propulsões </th>
              <td  mat-cell *matCellDef="let city" >
                  {{ city.propulsao_name.join(',  ') }}
              </td>
            </ng-container> 
                
            <ng-container matColumnDef="action">
              <th mat-header-cell *matHeaderCellDef> Ações </th>
              <td  mat-cell *matCellDef="let city" >
                  <div class="d-flex justify-content-center align-items-center " >
                      <span class="material-icons edit"  (click)="editCity(city)" [matTooltip]="'Editar cidade'">edit</span>
                      <span class="material-icons  delete"  [matTooltip]="'Excluir cidade'" (click)="onRemove(city)">delete</span>
                  </div>
  
                </td>
            </ng-container>
                
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  
      </table>
  
      <br>
      <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </div>
    
  </div>
    

<div class="loading-overlay" *ngIf="isLoading">
  <div class="spinner-grow " role="status" style="width: 50px; height: 50px;"  >
    <span class="sr-only">Loading...</span>
  </div>
</div> 

    
